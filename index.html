function doGet(e) {
  var dateToFind = e.parameter.date;
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var rows = sheet.getDataRange().getValues();
  
  var foundRow = null;
  var tmcTotal = 0;
  var tmcCash = 0;
  var tmcUpi = 0;
  
  for (var i = 1; i < rows.length; i++) {
    var rowDate = Utilities.formatDate(new Date(rows[i][0]), Session.getScriptTimeZone(), "yyyy-MM-dd");
    
    // TMC calculation (sab entries ka total jab tak wo date na aa jaye)
    tmcTotal += Number(rows[i][17] || 0); // Column R (Today Total)
    tmcCash += (Number(rows[i][1] || 0) + Number(rows[i][5] || 0)); // Gym Cash + PT Cash
    tmcUpi += (Number(rows[i][2] || 0) + Number(rows[i][6] || 0)); // Gym UPI + PT UPI
    
    if (rowDate === dateToFind) {
      foundRow = rows[i];
      // Report milte hi loop rok do taaki aage ka TMC add na ho
      return ContentService.createTextOutput(JSON.stringify({
        status: "Found",
        row: foundRow,
        tmcTotal: tmcTotal,
        tmcCash: tmcCash,
        tmcUpi: tmcUpi
      })).setMimeType(ContentService.MimeType.JSON);
    }
  }
  return ContentService.createTextOutput(JSON.stringify({status: "Not Found"})).setMimeType(ContentService.MimeType.JSON);
}
